// File: filterBox.js
loader([{type:"$",value:".js-filter-box"}]).ready(function(a){function b(){var b,c=n.find("A.selected").attr("continentid"),d=a.find(".js-etf-country-filter option:selected").attr("country_id"),e=a.find(".js-issuer-filter option:selected").val(),f=a.find(".js-asset-filter option:selected").val(),g=!1,h=a.find(".js-underlying-filter");a.find("select").prop("disabled",!0),h.length&&!h.hasClass("displayNone")&&(g=h.find("option:selected").val()),b={action:"etfsFilter",continent_id:c,country_id:d,issuer:e,asset:f,underlying:g},$.get("/common/ajax_func.php",b,function(b){a.find(".js-inner-filters").html(b),i()})}function c(){var b,c=n.find("A.selected").attr("continentid"),d=a.find(".js-certificate-country-filter option:selected").attr("country_id"),e=a.find(".js-issuer-filter option:selected").val(),f=a.find(".js-certificate-callput-filter option:selected").val(),g=a.find(".js-maturityFrom-filter option:selected").val(),h=a.find(".js-maturityTo-filter option:selected").val(),j=a.find(".js-asset-filter option:selected").val(),k=a.find(".js-type-filter option:selected").val(),l=!1,m=a.find(".js-underlying-filter");strikePrice=a.find(".js-strikePrice-filter option:selected").val(),a.find("select").prop("disabled",!0),m.length&&!m.hasClass("displayNone")&&(l=m.find("option:selected").val()),g>h&&i(),b={action:"certificatesFilter",continent_id:c,country_id:d,issuer:e,asset:j,underlying:l,callput:f,type:k,maturityFrom:g,maturityTo:h,strikePrice:strikePrice},$.get("/common/ajax_func.php",b,function(b){a.find(".js-inner-filters").html(b),i()})}function d(){$(this).hasClass("js-fund-country-filter")?data={action:"fundsFilter",continent_id:n.find("A.selected").attr("continentid"),country_id:+a.find(".js-fund-country-filter option:selected").attr("country_id")}:data={action:"fundsFilter",continent_id:n.find("A.selected").attr("continentid"),country_id:+a.find(".js-fund-country-filter option:selected").attr("country_id"),issuer:a.find(".js-issuer-filter option:selected").val(),asset:+a.find(".js-asset-filter option:selected").val(),rating:+a.find(".js-rating-filter option:selected").val(),riskRating:+a.find(".js-risk-rating-filter option:selected").val(),fundCategory:a.find(".js-category-filter option:selected").val()},a.find("select").prop("disabled",!0),$.get("/common/ajax_func.php",data,function(b){a.find(".js-inner-filters").html(b),i()})}function e(){var b=a.find(".js-etf-country-filter option:selected").val()+"?",c=+a.find(".js-asset-filter option:selected").val(),d=a.find(".js-issuer-filter option:selected").val(),e=+a.find(".js-underlying-filter option:selected").val();c&&(b+="&asset="+c),d&&(b+="&issuer_filter="+d),e&&(b+="&filter="+e),window.location=encodeURI(b)}function f(){var b=a.find(".js-certificate-country-filter option:selected").val()+"?",c=a.find(".js-issuer-filter option:selected").val(),d=a.find(".js-certificate-callput-filter option:selected").val(),e=+a.find(".js-maturityTo-filter option:selected").val(),f=+a.find(".js-maturityFrom-filter option:selected").val(),g=+a.find(".js-asset-filter option:selected").val(),h=a.find(".js-type-filter option:selected").val(),i=+a.find(".js-underlying-filter option:selected").val(),j=+a.find(".js-strikePrice-filter option:selected").val();console.log(c,d,g,h,i,f,e,j),c&&(b+="&issuer="+c),d&&(b+="&callput="+d),e&&(b+="&maturityTo="+e),f&&(b+="&maturityFrom="+f),g&&(b+="&asset="+g),h&&(b+="&type="+h),i&&(b+="&underlying="+i),j&&(b+="&strikePrice="+j),window.location=encodeURI(b)}function g(){var b=a.find(".js-fund-country-filter option:selected").val()+"?",c=+a.find(".js-asset-filter option:selected").val(),d=a.find(".js-issuer-filter option:selected").val(),e=+a.find(".js-rating-filter option:selected").val(),f=+a.find(".js-risk-rating-filter option:selected").val(),g=a.find(".js-category-filter option:selected").val();c&&(b+="&asset="+c),d&&(b+="&issuer_filter="+d),e>-1&&(b+="&rating="+e),f>-1&&(b+="&riskRating="+f),g&&(b+="&fundCategory="+g),window.location=encodeURI(b)}function h(){var b=a.find(".js-indice-country-filter option:selected").val()+"?";a.find('.filter input[type="checkbox"]:checked').each(function(){b+="&"+$(this).attr("name")+"=on"}),window.location=encodeURI(b)}function i(){switch(m){case"indice":a.find(".js-search-indices").on("click",h);break;case"bond":a.find(".js-bond-country-filter").on("change",k),a.find(".js-search-bonds").on("click",l);break;case"etf":a.find("select").on("change",b),a.find(".js-search-etfs").on("click",e),a.find("select").prop("disabled",!1);break;case"certificate":a.find("select").on("change",c),a.find(".js-search-certificates").on("click",f);break;case"fund":a.find("select").on("change",d),a.find(".js-search-funds").on("click",g),a.find("select").prop("disabled",!1)}}function j(b,c){if("currencyExplorer"==c)return changeCurrency(b);var d,e,f=$(b).data("smlId"),g=$(b).attr("continentid");$(b).addClass("selected").siblings().each(function(){$(this).removeClass("selected")}),$(b).unbind("click").siblings().each(function(){$(this).unbind("click"),$(this).bind({click:function(){j(this,c)}})}),$(window).trigger("multiFilter-ChangeFilterTypeAction",[b,f,c]),c.is("bond")?(changeBondsSelectFilter("all"),d={action:"bondsFilter",newSml:f,maturity_from:$("#newFilter #filter_maturity_from").val(),maturity_to:$("#newFilter #filter_maturity_to").val(),continentID:g},e=function(b){a.find(".js-inner-filters").html(b),i(),changeBondsSelectFilter("all")}):c.is("etf")?(d={action:"etfsFilter",continent_id:g},e=function(b){a.find(".js-inner-filters").html(b),i()}):c.is("fund")?(d={action:"fundsFilter",continent_id:g},e=function(b){a.find(".js-inner-filters").html(b),i()}):c.is("certificate")?(d={action:"certificatesFilter",continent_id:g},e=function(b){a.find(".js-inner-filters").html(b),i()}):c.is("indice")?(setFilter(),d={action:"indicesFilter",newSml:f,majorIndices:$("#newFilter #filter_majorIndices").val(),additionalIndices:$("#newFilter #filter_additionalIndices").val(),primarySectors:$("#newFilter #filter_primarySectors").val(),otherIndices:$("#newFilter #filter_otherIndices").val()},e=function(b){a.find(".js-inner-filters").html(b),i()}):c.is("central-bank")?(d={action:"worldCentralBankFilter",newSml:f,continent_id:g},e=function(a){$("#directoryFilter").html(a)}):c.is("global")?(setFilter(),d={action:"globalIndicesFilter",newSml:f,majorIndices:$("#newFilter #filter_majorIndices").val(),additionalIndices:$("#newFilter #filter_additionalIndices").val(),primarySectors:$("#newFilter #filter_primarySectors").val(),otherIndices:$("#newFilter #filter_otherIndices").val(),bonds:$("#newFilter #filter_bonds").val(),commodities:$("#newFilter #filter_commodities").val()},e=function(a){$("#directoryFilter").html(a),setFilter()}):c.is("bond indicesbonds")&&(changeBondsSelectFilter("all"),d={action:"indicesbondsFilter",newSml:f,continentID:$(b).attr("continentid")},e=function(a){$("#directoryFilter").html(a),changeBondsSelectFilter("all")}),d&&$.get("/common/ajax_func.php",d,e)}function k(){var b=n.find(".selected").attr("continentid"),c=+$(this).find("option:selected").attr("exchangeid"),d=a.find(".js-bond-country-filter option").filter(":selected").val();b||(b=0),$.get("/common/ajax_func.php",{action:"updateBondsMaturities",exchange_ID:c,continentID:b,country:d},function(b){a.find(".js-inner-filters").html(b),i()})}function l(){var b=a.find(".js-bond-country-filter option").filter(":selected").val()+"?";b+="maturity_from="+a.find(".js-maturity-from-filter option:selected").val(),b+="&maturity_to="+a.find(".js-maturity-to-filter option:selected").val(),window.location=encodeURI(b)}var m=a.attr("data-section"),n=a.find(".js-filter-box-table");i(),n.find("A").on("click",function(){j($(this),a.attr("data-section"))})});